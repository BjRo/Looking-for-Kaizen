
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dude, where's my Kaizen?</title>
  <meta name="author" content="Björn Rochel">

  
  <meta name="description" content="512 days or 17 months or 1.5 years. That&#8217;s the time between todays post and my last one.Not as long as the Duke Nukem Forever development time &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.bjoernrochel.de/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Dude, where's my Kaizen?" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><div id="logo">
	<img src="/images/kaizen.png" alt="Kaizen" title="Kaizen" />
</div>
<hgroup>
  <h1><a href="/">Dude, where's my Kaizen?</a></h1>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.bjoernrochel.de" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/11/15/at-the-crossroads/">At the Crossroads</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-11-15T09:59:00+01:00" pubdate  data-updated="true" >Nov 15<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>512 days or 17 months or 1.5 years. That&#8217;s the time between todays post and my last one.
Not as long as the Duke Nukem Forever development time, but it still strikes me how much
time has gone by since I&#8217;ve written something down here.</p>

<p>Today is probably going to be a very personal post and for that matter also non-technical one.</p>

<h2>So, what happened in those 512 days?</h2>

<p>First of all, 512 days ago I deliberately stopped blogging. I had lost all fun in writing.
It felt more than a burden than anything useful to me. Well I guess that had something to do
with a slowly and painful kind of burnout I experienced during my time at a large German consultancy.
It took me a while to realize what&#8217;s going on with me, but in the end, I think, I made the right
decision leaving the contracting, ups sorry, I mean consulting business.</p>

<p>I&#8217;ve spend a lot of my free time in the last 2 years doing some form of community
work. Not via blogging, but rather by</p>

<ul>
<li>Building <a href="http://www.github.com/bjro/machine.fakes/">Machine.Fakes</a>,</li>
<li>speaking at several conferences, user groups and open spaces,</li>
<li>facilitating the F# bookclub in Munich 2010 where we worked through <a href="http://www.manning.com/petricekt/">Real-World
Functional Programming</a>,</li>
<li>and helping <a href="http://www.der-albert.com/">Albert Weinert</a> to get the <a href="http://onlineusergroup.de">.NET Online User Group</a> off the ground.</li>
</ul>


<p>Besides I helped sucesfully delivering 3 large projects in the time. Two of them exceeded the customers expectations.
One didn&#8217;t. Simply put, I will never do any form of TFS customization again, never ever.</p>

<p>In mid 2010, out of curiosity, I bought my first Apple computer, a MacBook Pro. I started
to play around with it and actually liked it a lot. Guess what, I&#8217;m an IPhone and IPod owner, too.
I&#8217;m not religious about Apple products, though. They work for me and excactly deliver what
I expect and need from those devices.</p>

<p>Well, and after a while of using OSX, I began revisiting Ruby (after my initial steps in 2008) and
picked up where I left the last time. I learned the basics of using <a href="http://www.vim.org">VIM</a>,
<a href="http://www.git-scm.com">Git</a> and started to play around with <a href="http://www.rubyonrails.org">Ruby on Rails</a> and
with Rails the whole topic of web development (after having left the topic in 2003).</p>

<h2>Big changes are coming for me in 2012</h2>

<p>As you might have noticed, I&#8217;ve revived my blog. The design and the technology chosen might give you
an idea where this is all heading.</p>

<p>Next year I&#8217;m going to work in a new team, with non .NET technology, with a unix based OS as my primary development environment.
I&#8217;m really exited to join <a href="http://www.xing.de">XING</a> as a developer working on their <a href="http://www.rubyonrails.org">Ruby on Rails</a> based
platform.</p>

<p>Besides I&#8217;m planning to learn a new (non .NET) programming language next year, that currently feels completely alien to me, namely <a href="http://www.clojure.org">Clojure</a>.
If everything goes as planned we&#8217;re going to re-use the bookclub format we used in 2010 for the F# bookclub in Munich, though
in a somewhat virtualized form, and try to get into the <a href="http://www.joyofclosure.com">Joy of Clojure</a>.</p>

<p>Last but not least, I&#8217;m not nuts and discard everything I learned during the last years.
I&#8217;m probably going to play with MonoDevelop and try to learn how to build IPhone, Android, IPad and Cocoa apps using Mono.
At least that&#8217;s the plan.</p>

<h2>On leaving .NET</h2>

<p>What does leaving acutally mean? Let&#8217;s break this down a bit.</p>

<h3>Am I going to stop playing the active role for Machine.Fakes?</h3>

<p>Undecided, but probable since I won&#8217;t be using it on a day to day basis next year.
I&#8217;ve ideas for re-using it under mono, but I haven&#8217;t actually tried so far. We&#8217;ll see &#8230;</p>

<h3>Do I stop being in touch with parts of the .NET community?</h3>

<p>Don&#8217;t be silly</p>

<h3>Do I stop visiting .NET Open Spaces or UserGroups?</h3>

<p>Well, that is at least not my plan.</p>

<h2>What, no leaving .NET rant?</h2>

<p>In the last 4 years of active community involvement I had the honour and pleasure to get
to know a great bunch of .NET developers. Talented and gifted people, from all over Germany
(and even outside Germany), each of them awesome in his own way.</p>

<p>Just to name a few <a href="http://www.twitter.com/agross">@agross</a>, <a href="http://www.twitter.com/sforkmann">@sforkmann</a>, <a href="http://www.twitter.com/ilkerde">@ilkerde</a>, <a href="http://www.twitter.com/stefanlieser">@StefanLieser</a>,
<a href="http://www.twitter.com/mikebild">@mikebild</a>, <a href="http://www.twitter.com/sshishkin">@sshishkin</a>, <a href="http://www.twitter.com/lanwin">@lanwin</a>, <a href="http://www.twitter.com/cdeger">@cdeger</a>, <a href="http://www.twitter.com/oakinger">@oakinger</a>, <a href="http://www.twitter.com/jpboodhoo">@jpboodhoo</a>,
<a href="">@kostjaklein</a>, <a href="http://www.twitter.com/torstenweber">@torstenweber</a>, <a href="http://www.twitter.com/gregyoung">@gregyoung</a> and a lot more.  I could probably make the list a lot longer, but those are the people that managed to
leave a lasting impact on me. Thank you all!</p>

<p>The German .NET community has changed tremendously (for the good) in the time I&#8217;ve been
working with .NET, which is in great parts a result of the work of those people.
Moving away from focus solely on tools crafted by you know who, to embrace and teach practices/principles of
of professional software development, like SOLID, TDD/BDD/ATDD, Continuous Integration, Continuous Delivery, et al.</p>

<p>Microsoft (at least in my opinion) has also changed a lot (well at least in some areas, thank you ASP.NET team!).
They&#8217;re hosting code at publicly available locations, they&#8217;re accepting patches from the outside and they actually listen
carefully to community feedback. They still got a lot to improve, but hey, I wouldn&#8217;t believed you if you&#8217;d told me 4 years ago how parts of MS engage with
the community today.</p>

<h3>Why a technology change?</h3>

<p>Change often implies frustration or dissatisfaction with something. I want this
to be as clear as possible: <strong>Those are not my primary reasons</strong>.</p>

<p>I&#8217;m going to tell you a little secret right now, well sort of. Some of my older colleagues
know this, some still don&#8217;t:</p>

<p><strong>I never owned a computer before my 21st birthday. I didn&#8217;t even write a program till I was 22.</strong></p>

<p>Let that sink in for a moment.  Nevertheless, I somehow managed to leave every company I&#8217;ve worked for
in the the last 10 years with the impression that I was one of the top software
developers they ever worked with.</p>

<p>I often wondered how I managed to pull that off, but I guess it boils down to this: I really, really, really badly want to be
good at what I&#8217;m doing (whatever that is) and am willing to work as hard as necessary in order to reach that goal. I&#8217;ve had
my ups and downs with this strategy, but in the end it made me how I am and helped me to get where I am today. I honestly believe that you
can achieve much more than you might think, if you step out of what comforts you as often as possible
(though some people prefer to tell you the opposite and are very resistant with that).</p>

<blockquote><p>If you remain in your comfort zone you will not go any further</p><footer><strong>Catherine Pulsifer</strong><cite></cite></footer></blockquote>


<p><strong>If</strong> you&#8217;re passionate about what you do, <strong>if</strong> you put yourself in the
mood that you basically know nothing and that you can learn (in one way or another)
from nearly anybody around you, <strong>if</strong> you accept that you will fail in one
way or another and failing is ok if and only if you learn from failure,
and last but not least <strong>if</strong> you accept that for the most of us being good at something
actually is the result of continuous learning, hard work, deliberate practice and experience (as
opposed to talent only), <strong> than you define what&#8217;s possible for you and not somebody else.</strong></p>

<p>I&#8217;d like to think about myself as a developer, not as a C# developer, not as a OO
developer, not as an ASP.NET developer, nor Javascript developer for that matters.
Developer, just developer. Building awesome products in teams is my passion, but not building
awesome products with technlogy X,Y or Z. Languages, technlogies are <strong>part of my toolset, not something I&#8217;m
married to</strong> till death tears us apart.</p>

<p>Number 1 reason for making a technology change is that I want to extend my personal toolset</p>

<h3>Is that all?</h3>

<p>It&#8217;s no big secret that being an engaged person that likes to think outside the
box and not limits his views to the Microsoft way of building software, can
sometimes have a hard time in the Microsoft ecosystem (especially if you like to
work with teams and don&#8217;t want to go down the independent consultant road).</p>

<p>It&#8217;s utterly frustrating to hear from Microsoft evangelists that you&#8217;re not part
of the target group for their product (!!! Visual Studio !!!) if you ask for
more extensibility and less re-implementations of existing open source solutions
(No shit, that really happened to me 1 month ago and I still can&#8217;t believe they
actually said that).</p>

<p>I like the .NET framework and I especially like C#, but I&#8217;m more and
more frustrated with their sales driven approach to software development.  The frustrating part is that in
the end I can understand why they bundle/entangle their products from a sales perspective.
It&#8217;s probably my fault for not realizing earlier that this somewhat clashes
with my slightly opinionated approach to building software.</p>

<p>I sometimes tend to think that a greater part of us (of the .NET community)
would live a lot happier professional live outside the MS ecosystem and those
of us that do manage to pull that off inside that MS ecosystem have build
themselves <strong>a beautiful oasis in a vast and wide desert</strong>.</p>

<p>My current  project team is an example of the latter, using a mix of techniques from
Lean, ATDD , BDD, with feature branching and extensive code review sessions.
And all that is possible without the TFS and without 80% of the features of Visual
Studio. Who would have thought that &#8230;</p>

<p>However this team is breaking apart at the end of the year and I&#8217;m in the
position to start something new next year.  Trying to get a new .NET team
to the same state (or above) was an option, but I decided against that. Instead I
decided to venture into new territory, to extend my toolkit with
a new language and a new platform.</p>

<h3>Why Ruby?</h3>

<blockquote><p>I skate to where the puk is going to be, not where it has been</p><footer><strong>Wayne Gretzky</strong><cite></cite></footer></blockquote>


<p>I really, really like the quote, I really do, but do I think Ruby is the next
big thing?</p>

<p><strong>Honestly, I don&#8217;t</strong></p>

<p>I don&#8217;t say this in any negative way.  At the end of the end of the day
Ruby is just a tool (though awesome tool) that can be used,
misused and abused for getting things done.</p>

<p>What I&#8217;m more interested in is the Ruby community itself or even more
precise the state of engineering practices in the community. From the outside
they look far ahead than the common denominator in the Microsoft world.  Lots and lots of
.NET OSS frameworks and tools have been influenced by the Ruby community
in one way or another.</p>

<blockquote><p>The Moslems have a proverb,  to understand a man, you&#8217;ve got to walk a mile in his shoes, whether they fit or not.</p><footer><strong>Raymond Wiley Miller</strong><cite>1964</cite></footer></blockquote>


<p>The Ruby community seems to be a great starting point for my venture.
Lots of innovation going on, lots of passion involved, very OSS centered
and goal orientated.  However, I will never know for sure if those expectations
hold up to the reality unless I work amongst them for a while &#8230;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/06/21/prio-conference-2010/">Prio Conference 2010</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-06-21T08:26:00+02:00" pubdate  data-updated="true" >Jun 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In case you haven’t heard it yet, I’m going to give 2 talks at this years <a href="http://www.prioconference.de/" title="prio. conference">prio conference</a>.</p>

<p><img src="/images/posts/prioSpreaker-Banner.gif" title="Prio conference 2010" alt="prio conference logo" /></p>

<p>I’m very exited to be part of <a href="http://www.prioconference.de/Speaker/Speaker-prio.conference-2010" title="prio 2010 speakers">this years speaker line up</a> (though the quality of the line up is a bit intimidating ;-)).
Both talks will be on the <a href="http://www.prioconference.de/Programm/Programm-prio.conference-20.-Oktober-2010/prio.conference-Track-32">20th of October in Track 4</a></p>

<ul>
<li>10.05 – 11.05h, Introduction to Rhino.ServiceBus</li>
<li>15.20h – 16.20h, (ServiceBus) Patters for always responsive clients</li>
</ul>


<p>Looking forward to see you there &#8230;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/06/21/net-open-space-sd-retrospective/">.NET Open Space Süd Retrospective</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-06-21T07:46:59+02:00" pubdate  data-updated="true" >Jun 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I haven&#8217;t blogged in a while, mostly because time has become such a limited resource in the last weeks or to be honest actually months.
Blogging, my current project, workshops, the F# Bookclub, preparation of the next conference appearances and of course xUnit.BDDExtensions all want a piece of that cake.
Finding the right balance between those tasks is often not as easy as I would like it to be.
More often as I like skipping blogging seems to be the easiest way to regain some time.
I’m really sorry for that, but you know I try to do my best.
On the other hand this is a new blog post, so things can’t be that bad, can’t they?
Although I haven’t slept much the last 3 days, something inside me urges to write this post.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/06/21/net-open-space-sd-retrospective/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/05/12/kata-stringcalculator-in-f/">Kata StringCalculator in F#</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-05-12T19:36:38+02:00" pubdate  data-updated="true" >May 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday&#8217;s F# bookclub meeting in Munich was awesome as usual. It’s very interesting to see our overall understanding of functional programming progressing.
Slowly, but steady. Main topics we discussed on the last meeting were Currying and Tail Recursion. Finally &#8220;got that&#8221; (at least I think so ;-))</p>

<p>Two meetings ago we decided to do some coding on every meeting. The previous meeting we solved Kata FizzBuzz and on yesterday’s meeting we tried to dance with
<a href="http://osherove.com/tdd-kata-1/">Roy Osheroves StringCalculator</a>. We didn&#8217;t make it completely to the end, but I think we solved most of the Kata.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/05/12/kata-stringcalculator-in-f/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/04/29/kata-fizzbuzz-in-f/">Kata FizzBuzz in F#</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-04-29T19:00:00+02:00" pubdate  data-updated="true" >Apr 29<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last F# book club meeting in Munich was awesome (as usual). 2 weeks ago we decided to do a Code Kata on each subsequent meeting. This week was our first, with Kata FizzBuzz.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/04/29/kata-fizzbuzz-in-f/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/04/19/testing-f-code-with-xunit-net-on-net-4-0/">Testing F# Code With xUnit.net (on .NET 4.0)</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-04-19T08:48:46+02:00" pubdate  data-updated="true" >Apr 19<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A lot of my free time currently goes into learning F#.
While I had a great time playing around with the F# REPL FSI, I came to the conclusion that using FSI is not my
preferred way of a) learning the F# language and b) to develop code.
Writing unit tests simply for the purpose of learning and understanding of a language/component/system (aka &quot;Learning tests&quot;) seems to be a better fit,
at least for me. So, I sat down in order to see how I can use my beloved xUnit.net for this.
As it turns out it&#8217;s not that difficult, but it&#8217;s got some hurdles.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/04/19/testing-f-code-with-xunit-net-on-net-4-0/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/15/cutting-the-fluff-from-service-registration-with-structuremap-revisited/">Cutting the Fluff From Service Registration With StructureMap - Revisited</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-03-15T21:28:45+01:00" pubdate  data-updated="true" >Mar 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is just a quick update of an <a href="/2009/07/24/cutting-the-fluff-from-service-registration-or-how-to-do-funky-stuff-with-coc-castledynamicproxy-structuremap/">older post of mine</a>.
Since StructureMap&#8217;s convention API has <a href="/2010/01/05/changes-in-structuremap-254/">changed quite a bit</a>,
here is the updated version of the code used in the post using the new APIs introduced in StructureMap 2.5.4.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/03/15/cutting-the-fluff-from-service-registration-with-structuremap-revisited/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/25/plain-old-clr-c-object/">Plain Old CLR / C# Object</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-02-25T20:51:37+01:00" pubdate  data-updated="true" >Feb 25<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Crap, time can go by so fast. On Monday a <a href="http://twitter.com/ralfw/status/9446904971">tweet</a> by <strong>Ralf Westphal</strong> caught
my attention and I felt the need to comment. It started as a series of Twitter replies, but to be honest Twitter isn’t suited or made for those kind of discussions.
So I started to write this post in order to explain why I disagree with Ralf (or at least don’t get the intended message of his tweet).
Yeah a short look into the calendar indicates that I’m a little late, but I thought better late than ditch the post and forget about it.</p>

<h2>What got me baffled</h2>

<p>In his tweet he basically states (my translation from German to English) that</p>

<blockquote><p>If a domain model consists only of POCOs it should be called data model</p><footer><strong>Ralf Westphal</strong><cite><a href='http://twitter.com/ralfw/status/9446904971'>twitter.com/ralfw/status/&hellip;</a></cite></footer></blockquote>


<p>My first thought was a) does he mean anemic domain models and b) what has POCO to do with that? As I found out he didn’t mean
<a href="http://twitter.com/ralfw/status/9493173442">anemic domain models</a>. So let’s take a look at the POCO aspect.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/02/25/plain-old-clr-c-object/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/15/diving-into-the-storyteller-trunk-part-11-3-commands-strike-back/">Diving Into the StoryTeller Trunk, Part 11.3: Commands Strike Back</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-02-15T20:21:20+01:00" pubdate  data-updated="true" >Feb 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the things that can hit you really hard when writing blog posts about open source software (like StoryTeller is),
is the fact that your posts tend to get very fast outdated, especially when you don&#8217;t pay that much attention to the detail (like I did, sigh).
If you&#8217;re not aware of what I&#8217;m talking about, it&#8217;s StoryTellers command story. I&#8217;m not sure when it changed but it definitely has changed and I
needed to update my last post <a href="/2010/01/09/diving-into-the-storyteller-trunk-part-11-2-more-on-commands/">11.2</a> quite a bit in order
to reflect the changes. Today I would like to conclude my trip through StoryTellers UI infrastructure with a look at how Commands are integrated
into the Screen Activation Lifecycle.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/02/15/diving-into-the-storyteller-trunk-part-11-3-commands-strike-back/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/09/how-to-integrate-a-topshelf-based-service-with-vs-setup-projects/">How to: Integrate a Topshelf Based Service With vs Setup Projects</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-01-09T20:40:28+01:00" pubdate  data-updated="true" >Jan 9<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We’ve recently started to migrate all of our Windows Services from a classic ServiceBase based approach to the hosting framework Topshelf.</p>

<p>Previously we used the standard ServiceInstaller / ServiceProcessInstaller tandem to integrate our services with MSI deployment.
This does not work with Topshelf (since Topshelf does the service installation itself via the Registry).
However it’s pretty easy to write a custom installer for that. You can do something like this:</p>

<figure class='code'><figcaption><span>An installer for Topshelf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">TopshelfInstaller</span> <span class="p">:</span> <span class="n">Installer</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">AssemblyIdentifier</span> <span class="p">=</span> <span class="s">&quot;TopshelfAssembly&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">InstallUtilAssemblyParameter</span> <span class="p">=</span> <span class="s">&quot;assemblypath&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Install</span><span class="p">(</span><span class="n">IDictionary</span> <span class="n">stateSaver</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">var</span> <span class="n">topshelfAssembly</span> <span class="p">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="n">InstallUtilAssemblyParameter</span><span class="p">];</span>
</span><span class='line'>        <span class="n">stateSaver</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">AssemblyIdentifier</span><span class="p">,</span> <span class="n">topshelfAssembly</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">RunHidden</span><span class="p">(</span><span class="n">topshelfAssembly</span><span class="p">,</span> <span class="s">&quot;/install&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">base</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">stateSaver</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Uninstall</span><span class="p">(</span><span class="n">IDictionary</span> <span class="n">savedState</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">var</span> <span class="n">topshelfAssembly</span> <span class="p">=</span> <span class="n">savedState</span><span class="p">[</span><span class="n">AssemblyIdentifier</span><span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">RunHidden</span><span class="p">(</span><span class="n">topshelfAssembly</span><span class="p">,</span> <span class="s">&quot;/uninstall&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">base</span><span class="p">.</span><span class="n">Uninstall</span><span class="p">(</span><span class="n">savedState</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunHidden</span><span class="p">(</span><span class="kt">string</span> <span class="n">primaryOutputAssembly</span><span class="p">,</span> <span class="kt">string</span> <span class="n">arguments</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">var</span> <span class="n">startInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ProcessStartInfo</span><span class="p">(</span><span class="n">primaryOutputAssembly</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">WindowStyle</span> <span class="p">=</span> <span class="n">ProcessWindowStyle</span><span class="p">.</span><span class="n">Hidden</span><span class="p">,</span>
</span><span class='line'>            <span class="n">Arguments</span> <span class="p">=</span> <span class="n">arguments</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">process</span> <span class="p">=</span> <span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">startInfo</span><span class="p">))</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">process</span><span class="p">.</span><span class="n">WaitForExit</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The interesting part is this line:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">var</span> <span class="n">topshelfAssembly</span> <span class="p">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="n">InstallUtilAssemblyParameter</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>Took me some time to find this. During installation the Parameter Dictionary attached to the Context
contains the full target filename of the assembly being installed (key is <code>assemblypath</code>).
With this path you can directly launch the <code>/install</code> or <code>/uninstall</code> command for the Topshelf based exe.</p>

<p>HTH</p>

<p>P.S.: <a href="http://devcity.net/Articles/339/3/article.aspx">This</a> resource pointed me in the right direction.</p>
</div>
  
  


    </article>
  
  <nav class="pagination">
    <div>
      
        <a class="prev" href="/blog/page/2/">&larr; Older</a>
      
      <a href="/blog/archives">Blog Archives</a>
      
    </div>
  </nav>
</div>
<aside class="sidebar">
  
    <section>
	<h1>About me</h1>
  <p><br/><img src="/images/bjro-eyes.jpg" alt="portrait" /></p>
	<p>
  My name is <strong>Björn Rochel</strong>.  I&#8217;m a 32 year old geek, who&#8217;s crazy about software development, living in Cologne and
  currently working for <a href="http://www.intercomponentware.com">ICW</a> as a .NET Developer / Architect.
	</p>
	<ul class="badges">
		<li><a href="http://www.xing.com/profile/Bjoern_Rochel"><img src="/images/badges/xing2-small.png" alt="Xing" /></a></li>
		<li><a href="http://www.github.com/BjRo"><img src="/images/badges/github-small.png" alt="Github" /></a></li>
		<li><a href="http://www.twitter.com/bjoernrochel"><img src="/images/badges/twitter-square-small.png" alt="Twitter" /></a></li>
		<li><a href="/atom.xml"><img src="/images/badges/rss-circle-small.png" alt="Rss" /></a></li>
	</ul>
</section>

<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/Conferences/'>Conferences (8)</a></li>
<li class='category'><a href='/blog/categories/FSharp/'>FSharp (3)</a></li>
<li class='category'><a href='/blog/categories/Katas/'>Katas (2)</a></li>
<li class='category'><a href='/blog/categories/StoryTeller/'>StoryTeller (14)</a></li>
<li class='category'><a href='/blog/categories/StructureMap/'>StructureMap (9)</a></li>
<li class='category'><a href='/blog/categories/Testing/'>Testing (20)</a></li>
<li class='category'><a href='/blog/categories/Uncategorized/'>Uncategorized (8)</a></li>
<li class='category'><a href='/blog/categories/dotnet/'>dotnet (65)</a></li>
<li class='category'><a href='/blog/categories/ruby/'>ruby (3)</a></li>
<li class='category'><a href='/blog/categories/sw-design/'>sw-design (13)</a></li>
<li class='category'><a href='/blog/categories/xUnitBDDExtensions/'>xUnitBDDExtensions (15)</a></li>

  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("bjoernrochel", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/bjoernrochel" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @bjoernrochel</a>
  
</section>

<section>
<h1>Disclaimer</h1>
<p>
The opinions expressed herein are my own personal opinions and do not necessarily represent the opinion of any other organization or person, including (but not limited to) my fellow employees, my employer, its clients or their agents. 
</p>
<p>
 Copyright &copy; 2011 - Björn Rochel
</p>
<section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - Björn Rochel -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'bjro';
      
        
        var disqus_script = 'count.js';
      

    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
