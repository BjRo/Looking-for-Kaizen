
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dude, where's my Kaizen?</title>
  <meta name="author" content="Björn Rochel">

  
  <meta name="description" content="In case you haven’t heard it yet, I’m going to give 2 talks at this years prio conference.I’m very exited to be part of this years speaker line up ( &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.bjoernrochel.de/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Dude, where's my Kaizen?" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><div id="logo">
	<img src="/images/kaizen.png" alt="Kaizen" title="Kaizen" />
</div>
<hgroup>
  <h1><a href="/">Dude, where's my Kaizen?</a></h1>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.bjoernrochel.de" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/06/21/prio-conference-2010/">Prio Conference 2010</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-06-21T08:26:00+02:00" pubdate  data-updated="true" >Jun 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In case you haven’t heard it yet, I’m going to give 2 talks at this years <a href="http://www.prioconference.de/" title="prio. conference">prio conference</a>.</p>

<p><img src="/images/posts/prioSpreaker-Banner.gif" title="Prio conference 2010" alt="prio conference logo" /></p>

<p>I’m very exited to be part of <a href="http://www.prioconference.de/Speaker/Speaker-prio.conference-2010" title="prio 2010 speakers">this years speaker line up</a> (though the quality of the line up is a bit intimidating ;-)).
Both talks will be on the <a href="http://www.prioconference.de/Programm/Programm-prio.conference-20.-Oktober-2010/prio.conference-Track-32">20th of October in Track 4</a></p>

<ul>
<li>10.05 – 11.05h, Introduction to Rhino.ServiceBus</li>
<li>15.20h – 16.20h, (ServiceBus) Patters for always responsive clients</li>
</ul>


<p>Looking forward to see you there &#8230;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/06/21/net-open-space-sd-retrospective/">.NET Open Space Süd Retrospective</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-06-21T07:46:59+02:00" pubdate  data-updated="true" >Jun 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I haven&#8217;t blogged in a while, mostly because time has become such a limited resource in the last weeks or to be honest actually months.
Blogging, my current project, workshops, the F# Bookclub, preparation of the next conference appearances and of course xUnit.BDDExtensions all want a piece of that cake.
Finding the right balance between those tasks is often not as easy as I would like it to be.
More often as I like skipping blogging seems to be the easiest way to regain some time.
I’m really sorry for that, but you know I try to do my best.
On the other hand this is a new blog post, so things can’t be that bad, can’t they?
Although I haven’t slept much the last 3 days, something inside me urges to write this post.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/06/21/net-open-space-sd-retrospective/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/05/12/kata-stringcalculator-in-f/">Kata StringCalculator in F#</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-05-12T19:36:38+02:00" pubdate  data-updated="true" >May 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday&#8217;s F# bookclub meeting in Munich was awesome as usual. It’s very interesting to see our overall understanding of functional programming progressing.
Slowly, but steady. Main topics we discussed on the last meeting were Currying and Tail Recursion. Finally &#8220;got that&#8221; (at least I think so ;-))</p>

<p>Two meetings ago we decided to do some coding on every meeting. The previous meeting we solved Kata FizzBuzz and on yesterday’s meeting we tried to dance with
<a href="http://osherove.com/tdd-kata-1/">Roy Osheroves StringCalculator</a>. We didn&#8217;t make it completely to the end, but I think we solved most of the Kata.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/05/12/kata-stringcalculator-in-f/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/04/29/kata-fizzbuzz-in-f/">Kata FizzBuzz in F#</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-04-29T19:00:00+02:00" pubdate  data-updated="true" >Apr 29<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last F# book club meeting in Munich was awesome (as usual). 2 weeks ago we decided to do a Code Kata on each subsequent meeting. This week was our first, with Kata FizzBuzz.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/04/29/kata-fizzbuzz-in-f/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/04/19/testing-f-code-with-xunit-net-on-net-4-0/">Testing F# Code With xUnit.net (on .NET 4.0)</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-04-19T08:48:46+02:00" pubdate  data-updated="true" >Apr 19<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A lot of my free time currently goes into learning F#.
While I had a great time playing around with the F# REPL FSI, I came to the conclusion that using FSI is not my
preferred way of a) learning the F# language and b) to develop code.
Writing unit tests simply for the purpose of learning and understanding of a language/component/system (aka &quot;Learning tests&quot;) seems to be a better fit,
at least for me. So, I sat down in order to see how I can use my beloved xUnit.net for this.
As it turns out it&#8217;s not that difficult, but it&#8217;s got some hurdles.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/04/19/testing-f-code-with-xunit-net-on-net-4-0/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/15/cutting-the-fluff-from-service-registration-with-structuremap-revisited/">Cutting the Fluff From Service Registration With StructureMap - Revisited</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-03-15T21:28:45+01:00" pubdate  data-updated="true" >Mar 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is just a quick update of an <a href="/2009/07/24/cutting-the-fluff-from-service-registration-or-how-to-do-funky-stuff-with-coc-castledynamicproxy-structuremap/">older post of mine</a>.
Since StructureMap&#8217;s convention API has <a href="/2010/01/05/changes-in-structuremap-254/">changed quite a bit</a>,
here is the updated version of the code used in the post using the new APIs introduced in StructureMap 2.5.4.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/03/15/cutting-the-fluff-from-service-registration-with-structuremap-revisited/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/25/plain-old-clr-c-object/">Plain Old CLR / C# Object</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-02-25T20:51:37+01:00" pubdate  data-updated="true" >Feb 25<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Crap, time can go by so fast. On Monday a <a href="http://twitter.com/ralfw/status/9446904971">tweet</a> by <strong>Ralf Westphal</strong> caught
my attention and I felt the need to comment. It started as a series of Twitter replies, but to be honest Twitter isn’t suited or made for those kind of discussions.
So I started to write this post in order to explain why I disagree with Ralf (or at least don’t get the intended message of his tweet).
Yeah a short look into the calendar indicates that I’m a little late, but I thought better late than ditch the post and forget about it.</p>

<h2>What got me baffled</h2>

<p>In his tweet he basically states (my translation from German to English) that</p>

<blockquote><p>If a domain model consists only of POCOs it should be called data model</p><footer><strong>Ralf Westphal</strong><cite><a href='http://twitter.com/ralfw/status/9446904971'>twitter.com/ralfw/status/&hellip;</a></cite></footer></blockquote>


<p>My first thought was a) does he mean anemic domain models and b) what has POCO to do with that? As I found out he didn’t mean
<a href="http://twitter.com/ralfw/status/9493173442">anemic domain models</a>. So let’s take a look at the POCO aspect.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/02/25/plain-old-clr-c-object/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/15/diving-into-the-storyteller-trunk-part-11-3-commands-strike-back/">Diving Into the StoryTeller Trunk, Part 11.3: Commands Strike Back</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-02-15T20:21:20+01:00" pubdate  data-updated="true" >Feb 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the things that can hit you really hard when writing blog posts about open source software (like StoryTeller is),
is the fact that your posts tend to get very fast outdated, especially when you don&#8217;t pay that much attention to the detail (like I did, sigh).
If you&#8217;re not aware of what I&#8217;m talking about, it&#8217;s StoryTellers command story. I&#8217;m not sure when it changed but it definitely has changed and I
needed to update my last post <a href="/2010/01/09/diving-into-the-storyteller-trunk-part-11-2-more-on-commands/">11.2</a> quite a bit in order
to reflect the changes. Today I would like to conclude my trip through StoryTellers UI infrastructure with a look at how Commands are integrated
into the Screen Activation Lifecycle.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/02/15/diving-into-the-storyteller-trunk-part-11-3-commands-strike-back/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/09/how-to-integrate-a-topshelf-based-service-with-vs-setup-projects/">How to: Integrate a Topshelf Based Service With vs Setup Projects</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-01-09T20:40:28+01:00" pubdate  data-updated="true" >Jan 9<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We’ve recently started to migrate all of our Windows Services from a classic ServiceBase based approach to the hosting framework Topshelf.</p>

<p>Previously we used the standard ServiceInstaller / ServiceProcessInstaller tandem to integrate our services with MSI deployment.
This does not work with Topshelf (since Topshelf does the service installation itself via the Registry).
However it’s pretty easy to write a custom installer for that. You can do something like this:</p>

<figure class='code'><figcaption><span>An installer for Topshelf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">TopshelfInstaller</span> <span class="p">:</span> <span class="n">Installer</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">AssemblyIdentifier</span> <span class="p">=</span> <span class="s">&quot;TopshelfAssembly&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">InstallUtilAssemblyParameter</span> <span class="p">=</span> <span class="s">&quot;assemblypath&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Install</span><span class="p">(</span><span class="n">IDictionary</span> <span class="n">stateSaver</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">var</span> <span class="n">topshelfAssembly</span> <span class="p">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="n">InstallUtilAssemblyParameter</span><span class="p">];</span>
</span><span class='line'>        <span class="n">stateSaver</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">AssemblyIdentifier</span><span class="p">,</span> <span class="n">topshelfAssembly</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">RunHidden</span><span class="p">(</span><span class="n">topshelfAssembly</span><span class="p">,</span> <span class="s">&quot;/install&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">base</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">stateSaver</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Uninstall</span><span class="p">(</span><span class="n">IDictionary</span> <span class="n">savedState</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">var</span> <span class="n">topshelfAssembly</span> <span class="p">=</span> <span class="n">savedState</span><span class="p">[</span><span class="n">AssemblyIdentifier</span><span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">RunHidden</span><span class="p">(</span><span class="n">topshelfAssembly</span><span class="p">,</span> <span class="s">&quot;/uninstall&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">base</span><span class="p">.</span><span class="n">Uninstall</span><span class="p">(</span><span class="n">savedState</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunHidden</span><span class="p">(</span><span class="kt">string</span> <span class="n">primaryOutputAssembly</span><span class="p">,</span> <span class="kt">string</span> <span class="n">arguments</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">var</span> <span class="n">startInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ProcessStartInfo</span><span class="p">(</span><span class="n">primaryOutputAssembly</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">WindowStyle</span> <span class="p">=</span> <span class="n">ProcessWindowStyle</span><span class="p">.</span><span class="n">Hidden</span><span class="p">,</span>
</span><span class='line'>            <span class="n">Arguments</span> <span class="p">=</span> <span class="n">arguments</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">process</span> <span class="p">=</span> <span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">startInfo</span><span class="p">))</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">process</span><span class="p">.</span><span class="n">WaitForExit</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The interesting part is this line:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">var</span> <span class="n">topshelfAssembly</span> <span class="p">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="n">InstallUtilAssemblyParameter</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>Took me some time to find this. During installation the Parameter Dictionary attached to the Context
contains the full target filename of the assembly being installed (key is <code>assemblypath</code>).
With this path you can directly launch the <code>/install</code> or <code>/uninstall</code> command for the Topshelf based exe.</p>

<p>HTH</p>

<p>P.S.: <a href="http://devcity.net/Articles/339/3/article.aspx">This</a> resource pointed me in the right direction.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/09/diving-into-the-storyteller-trunk-part-11-2-more-on-commands/">Diving Into the StoryTeller Trunk, Part 11.2: More on Commands</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-01-09T20:38:35+01:00" pubdate  data-updated="true" >Jan 9<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Let’s take a look at some of the questions I left unanswered in the last post.</p>

<h2>Is the basic GoF Command pattern sufficient for a modern composite application?</h2>

<p>The basic GoF Command pattern has no notion of visual state of a <code>Command</code>, such as <code>(Is)Enabled</code> or <code>(Is)Visible</code>.
Its original purpose was to encapsulate an action, so that it can be passed around and executed at some later point of time. Not more, not less.</p>

<figure class='code'><figcaption><span>The basic Command interface</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">ICommand</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">void</span> <span class="nf">Execute</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Obviously real world desktop apps need something a bit more sophisticated. I’ve seen several infrastructures in my (not so old)
career so far (home grown as well as OS alternatives), which extended this basic idea with at least one of those properties mentioned above.
Take for instance the P&amp;P Composite UI Application Block (now better known as part of the Smart Client Software Factory). CAB implements a
delegate based variation on the Command pattern. The delegate represents the action which is passed around. However, this delegate is managed by
the Command class which has a notion of Status.</p>

<figure class='code'><figcaption><span>CommandStatus in CAB</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">enum</span> <span class="n">CommandStatus</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">Enabled</span><span class="p">,</span> <span class="c1">//visible and enabled</span>
</span><span class='line'>  <span class="n">Disabled</span><span class="p">,</span> <span class="c1">//visible and disabled </span>
</span><span class='line'>  <span class="n">Unavailable</span> <span class="c1">//invisible </span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The WPF Command infrastructure version of the Command interface is more like the original pattern and adds the <code>Enabled</code> Property and an <code>EnabledChangedEvent</code> to the interface definition.</p>

<figure class='code'><figcaption><span>WPFs ICommand interface</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">ICommand</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">void</span> <span class="nf">Execute</span><span class="p">();</span>
</span><span class='line'>  <span class="kt">bool</span> <span class="n">Enabled</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">event</span> <span class="n">EventHandler</span> <span class="n">EnabledChanged</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To be honest, the <code>Command</code> interface <strong>never looked like the original GoF definition in
ANY APPLICATION or project I’ve worked on so far</strong>. It always had a slight modification in one or another way.</p>

<h2>StoryTeller’s Command interface</h2>

<p>StoryTeller is a WPF based application, so naturally it gets the WPF Command infrastructure out of the box. However it composes the
WPF <code>ICommand</code> into a StoryTeller specific structure, the <code>IScreenAction</code>.</p>

<figure class='code'><figcaption><span>The ScreenAction abstraction</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IScreenAction</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">bool</span> <span class="n">IsPermanent</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">InputBinding</span> <span class="n">Binding</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">Icon</span> <span class="n">Icon</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">ICommand</span> <span class="n">Command</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="kt">bool</span> <span class="n">ShortcutOnly</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">void</span> <span class="nf">BuildButton</span><span class="p">(</span><span class="n">ICommandBar</span> <span class="n">bar</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>IScreenAction</code> extends the capabilities of the original GoF-Pattern with a lot of metadata, mostly for visual aspects (Icon, Description).
If you’re wondering why he included visual aspects: That basically tries to solve a reoccurring problem in composite apps: In
composite applications modules are not known at compile time to the infrastructure. Neither are all their capabilities and how they might be
displayed in the infrastructure shell. Because of that, the infrastructure needs a dynamic, deferred way for doing the shells visual
configuration at application startup. One way to implement this is to delegate the responsibility for setting this up to the modules itself.
This can be done during the module load time or every time a screen is displayed. This fits very well with the idea of the Open Closed
Principle, since adding new modules/screens doesn’t require any reconfiguration/recompilation of other modules or the infrastructure.
This is more or less the approach that StoryTeller takes.</p>

<h2>Some personal thoughts on IScreenAction</h2>

<p>I’ve worked on three applications in the past which followed down the same road. One thing I noticed
throughout those three applications is that this approach isn’t really well suited when you’ve got strict and/or complex requirements about how
the UI of an application should look. Let me clarify a bit what I mean:</p>

<ul>
<li><strong>The Ordering Problem</strong>. Even if you organize tools representing commands in a simple toolbar (as StoryTeller does) you can very
easily get into situations where the product owner wants to have the tools in a very specific order which is different to module load
order, some internal event order, whatever. I’ve encountered this several times now. First time we solved this by introducing a global
constant class containing tool names. Very, very bad idea, do not repeat this. This introduces a kind of hidden temporal coupling,
because now modules must be loaded in a particular order (so that a tool already exists to which we can refer by name). StoryTellers
take on this is a bit better (but IMHO not much). The Icon class has an Integer based Order property. All tools get sorted based on this
property in StoryTellers CommandBar when it’s reloaded. This is less coupled, because it eliminates the temporal aspect of the coupling,
but still has coupling.</li>
<li><strong>API bloat with visual aspects</strong>. One area where I really started to find this approach annoying is when you stop having simple
toolbars and start to use more complex menu types like for instance the Ribbon. Taking the ribbon as an example: Now don’t have simply
an ordering problem, but at minimum an icon problem (Normal icon vs.  Quick Access Toolbar), a size problem (Displayed large or small) and
a positioning problem (/Tab/Group/ElementGroup vs.  /ApplicationMenu/Left). We added all those stuff to our Command
registration and guess what, we weren’t happy with that. We created a monster API actually doing very little.</li>
</ul>


<p>So what do I (currently) prefer? Our current project (also using the Ribbon) completely strips the visual aspect of the Command. Our Command
API looks very much like the WPF one, with the only addition of an Id property. The whole visual aspect is configured using an XML file which
is loaded at application startup.</p>

<figure class='code'><figcaption><span>Using xml to wire up the ribbon</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;</span><span class="n">Ribbon</span><span class="p">&gt;</span>
</span><span class='line'>   <span class="p">&lt;</span><span class="n">Tab</span><span class="p">&gt;</span>
</span><span class='line'>      <span class="p">&lt;</span><span class="n">Group</span><span class="p">&gt;</span>
</span><span class='line'>         <span class="p">&lt;</span><span class="n">Button</span> <span class="n">imageId</span><span class="p">=</span><span class="err">”</span><span class="n">CancelIcon</span><span class="err">“</span> <span class="n">commandId</span><span class="p">=</span><span class="err">”</span><span class="n">CommandXYZ</span><span class="err">”</span> <span class="p">/&gt;</span>
</span><span class='line'>      <span class="p">&lt;/</span><span class="n">Group</span><span class="p">&gt;</span>
</span><span class='line'>   <span class="p">&lt;/</span><span class="n">Tab</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">Ribbon</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I think you get the point. It works very well for our scope. (Slight warning though: This solution might not be the best in
case you need to represent menu state based on dynamically loaded data).</p>

<p>See you next time for: Commands strike back ;-)</p>
</div>
  
  


    </article>
  
  <nav class="pagination">
    <div>
      
        <a class="prev" href="/blog/page/2/">&larr; Older</a>
      
      <a href="/blog/archives">Blog Archives</a>
      
    </div>
  </nav>
</div>
<aside class="sidebar">
  
    <section>
	<h1>About me</h1>
  <p><br/><img src="/images/bjro-eyes.jpg" alt="portrait" /></p>
	<p>
  My name is <strong>Björn Rochel</strong>.  I&#8217;m a 32 year old geek, who&#8217;s crazy about software development, living in Cologne and
  currently working for <a href="http://www.intercomponentware.com">ICW</a> as a .NET Developer / Architect.
	</p>
	<ul class="badges">
		<li><a href="http://www.xing.com/profile/Bjoern_Rochel"><img src="/images/badges/xing2-small.png" alt="Xing" /></a></li>
		<li><a href="http://www.github.com/BjRo"><img src="/images/badges/github-small.png" alt="Github" /></a></li>
		<li><a href="http://www.twitter.com/bjoernrochel"><img src="/images/badges/twitter-square-small.png" alt="Twitter" /></a></li>
		<li><a href="/atom.xml"><img src="/images/badges/rss-circle-small.png" alt="Rss" /></a></li>
	</ul>
</section>

<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/Conferences/'>Conferences (8)</a></li>
<li class='category'><a href='/blog/categories/FSharp/'>FSharp (3)</a></li>
<li class='category'><a href='/blog/categories/Katas/'>Katas (2)</a></li>
<li class='category'><a href='/blog/categories/StoryTeller/'>StoryTeller (14)</a></li>
<li class='category'><a href='/blog/categories/StructureMap/'>StructureMap (9)</a></li>
<li class='category'><a href='/blog/categories/Testing/'>Testing (20)</a></li>
<li class='category'><a href='/blog/categories/Uncategorized/'>Uncategorized (7)</a></li>
<li class='category'><a href='/blog/categories/dotnet/'>dotnet (65)</a></li>
<li class='category'><a href='/blog/categories/ruby/'>ruby (3)</a></li>
<li class='category'><a href='/blog/categories/sw-design/'>sw-design (13)</a></li>
<li class='category'><a href='/blog/categories/xUnitBDDExtensions/'>xUnitBDDExtensions (15)</a></li>

  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("bjoernrochel", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/bjoernrochel" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @bjoernrochel</a>
  
</section>

<section>
<h1>Disclaimer</h1>
<p>
The opinions expressed herein are my own personal opinions and do not necessarily represent the opinion of any other organization or person, including (but not limited to) my fellow employees, my employer, its clients or their agents. 
</p>
<p>
 Copyright &copy; 2011 - Björn Rochel
</p>
<section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - Björn Rochel -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'bjro';
      
        
        var disqus_script = 'count.js';
      

    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
