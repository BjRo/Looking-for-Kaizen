
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Diving into the StoryTeller trunk, Part 6: The main players in the screen activation lifecycle - Dude, where's my Kaizen?</title>
  <meta name="author" content="Björn Rochel">

  
  <meta name="description" content="It has been an interesting time with the StoryTeller codebase so far.I&#8217;ve learned a lot about advanced StructureMap usage by scanning &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.bjoernrochel.de/2009/08/07/diving-into-the-storyteller-trunk-part-6-the-main-players-in-the-screen-activation-lifecycle/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Dude, where's my Kaizen?" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><div id="logo">
	<img src="/images/kaizen.png" alt="Kaizen" title="Kaizen" />
</div>
<hgroup>
  <h1><a href="/">Dude, where's my Kaizen?</a></h1>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.bjoernrochel.de" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Diving Into the StoryTeller Trunk, Part 6: The Main Players in the Screen Activation Lifecycle</h1>
    
    
      <p class="meta">
        





  



<time datetime="2009-08-07T19:42:40+02:00" pubdate  data-updated="true" >Aug 7<span>th</span>, 2009</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>It has been an interesting time with the StoryTeller codebase so far.
I&#8217;ve learned a lot about advanced StructureMap usage by scanning through
the code, trying to understand the unit tests, debugging StoryTeller and
writing some smaller programs based on the newly discovered patterns &amp;
features. However, my initial motivation for spending time with that
codebase wasn&#8217;t StructureMap or the Convention over Configuration topic
but rather StoryTellers implementation of the screen activation
lifecycle. Jeremy wrote bits about it in his &#8220;Build your Own Cab&#8221;
series, but they where rather abstract and didn&#8217;t show a lot of code.
Many responsibilities he described seemed totally logical to me, but I
had trouble putting all those concepts together into code (which mostly
undermines that I only understood have of the stuff I read ;-)). Things
became really interesting again when Jeremy showed more parts at the
Presentation Patterns talk at last NDC. Damn, I wasn&#8217;t aware that a lot
of the patterns he described were already implemented in the StoryTeller
codebase (or did they emerge after the recent rewrite ???). With part 6
of my Story Teller journey I would like to spend some time describing
the general players in the screen activation lifecycle. This will be a
no-code-post. A high level view so to say.</p>

<h2>ScreenCollection</h2>

<p>In his Presentation Patterns talk Jeremy described that the kind of desktop
application he worked on in the past implemented mostly one of two major
navigation styles: Tab-style navigation or Web-style-navigation..</p>

<ul>
<li>Tab-style-navigation more or less means that every new screen or
control is displayed on a different tab, a new content control in
the UI.</li>
<li>Web-style-navigation means that every new screen or control is
mostly displayed in the same content control and replaces the
previously displayed control. Basically a way how a browser handles
things (of course, in the old ages before the empire, hm I mean tab
;-)).</li>
</ul>


<p>StoryTeller implements a Tab-style navigation. However you don&#8217;t
interact with a TabControl directly in StoryTeller . It is exposed via
the <code>IScreenCollection</code> interface. The functionality of this interface is
mostly similar to CAL/CAG/PRISMs <code>IRegion</code> or the old <code>IWorkspace</code> interface
in CAB. However there&#8217;s a huge difference in what the <code>IScreenCollection</code>
accepts in his <code>Open</code>, <code>Close</code> or <code>Activate</code> methods. They don&#8217;t accept
UserControls or UIElements, they accept only instances implementing the
<code>IScreen</code> interface.</p>

<h2>Screen</h2>

<p>The complete screen activation lifecycle in StoryTeller is based on the <code>IScreen</code> interface and therefore
completely decoupled from the related UI technology. Testability, baby !!!</p>

<p>The screen interface is mostly implemented directly by Presenters or ViewModels and exposes methods for determining current caption for the
screen, or the activation and deactivation of commands. Screens are
created by a <code>ScreenSubject</code>.</p>

<h2>ScreenSubject </h2>

<p><code>ScreenSubject</code> is a really nice abstraction which deals with the creation and the identification of
a particular screen. This abstraction is really valuable in applications which behave a lot like Visual Studio when opening code files. Think
about it, when you first open up a source code file by double clicking it in the Source Code Explorer a new tab or window is created for it.
Double clicking the file again doesn&#8217;t open a new window but rather activates the related tab or window. That&#8217;s exactly what the
ScreenSubject abstraction tries to achieve, too. Freeing the consumer code from the decision whether to create a new screen or to activate an
already existing screen is the responsibility of the <code>ScreenSubject</code>
implementations.</p>

<h2>ShellConductor </h2>

<p>The <code>ShellConductor</code> is THE BIG PLAYER in the screen activation lifecycle. In Martin Fowlers terms the
<code>ShellConductor</code> fulfills the role of the <code>ApplicationController</code>. The <code>ShellConductor</code> is the piece of code that (besides some other topics)
controls and coordinates the whole Screen handling. He is responsible for screen activation and deactivation, controls the closing of Screens
and acts as kind of a facade for typical application code working with the framework. You could say that the ScreenConductor is an
<code>ApplicationController</code> broken down into more smaller, specialized parts.</p>

<p>As you can imagine the <code>ShellConductor</code> knows a lot of his buddies in the neighborhood. Just to give you an impression how a typical operation on
it might look like, I&#8217;d like to walk you through the simple topic of opening a screen in the UI. Here are the Steps:</p>

<ol>
<li>Client code calls <code>OpenScreen(new MyScreenSubject())</code> on the
<code>ShellConductor</code>.</li>
<li><code>ShellConductor</code> knows the <code>ScreenCollection</code> and tries to find a <code>IScreen</code>
matching the subject in the collection.</li>
<li>If a Screen was found, it&#8217;s activated.</li>
<li>If no Screen was found, the <code>ShellConductor</code>

<ol>
<li>creates the target screen via the supplied <code>ScreenSubject</code>,</li>
<li>adds it to the <code>ScreenCollection</code> and</li>
<li>activates it in the <code>ScreenCollection</code>.</li>
</ol>
</li>
</ol>


<p>The <code>ShellConductor</code> will be a larger topic I&#8217;m going to look into in one
of the next posts, so please forgive me for the moment if I continue my
overview with the last element for today, the <code>Shell</code>.</p>

<h2>Shell </h2>

<p>The <code>Shell</code> is the host window for the application. It&#8217;s the frame in which the
<code>ScreenCollection</code> and <code>Screens</code> are displayed. It&#8217;s actually pretty dumb,
since it only has kind of a container functionality.</p>

<h2>What I didn&#8217;t touch today </h2>

<p>To be honest there is a more in the StoryTeller UI layer
than the stuff I described today. On of the major topics for instance I
left out for the moment is the whole topic dealing with <code>Commands</code>,
<code>CommandBindings</code> and <code>InputGestures</code>. StoryTeller shows a nice way of how to use a little internal Dsl for defining Commands on the fly. So far
I&#8217;ve looked at it only sufficiently but it looks really promising. I&#8217;m
definitely going to spend a post or two for that topic, so stay tuned.</p>

<p>See you next time when it&#8217;s time to look at some code again &#8230;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">BjRo</span></span>

      





  



<time datetime="2009-08-07T19:42:40+02:00" pubdate  data-updated="true" >Aug 7<span>th</span>, 2009</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/storyteller/'>StoryTeller</a>, <a class='category' href='/blog/categories/dotnet/'>dotnet</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.bjoernrochel.de/2009/08/07/diving-into-the-storyteller-trunk-part-6-the-main-players-in-the-screen-activation-lifecycle/" data-via="bjoernrochel" data-counturl="http://www.bjoernrochel.de/2009/08/07/diving-into-the-storyteller-trunk-part-6-the-main-players-in-the-screen-activation-lifecycle/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
</div>

    
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
	<h1>About me</h1>
  <p><br/><img src="/images/bjro-eyes.jpg" alt="portrait" /></p>
	<p>
  My name is <strong>Björn Rochel</strong>.  I'm a 32 year old geek, who's crazy about software development, living in Cologne and
  currently working for <a href="http://www.intercomponentware.com">ICW</a> as a .NET Developer / Architect.
	</p>
	<ul class="badges">
		<li><a href="http://www.xing.com/profile/Bjoern_Rochel"><img src="/images/badges/xing2-small.png" alt="Xing" /></a></li>
		<li><a href="http://www.github.com/BjRo"><img src="/images/badges/github-small.png" alt="Github" /></a></li>
		<li><a href="http://www.twitter.com/bjoernrochel"><img src="/images/badges/twitter-square-small.png" alt="Twitter" /></a></li>
		<li><a href="/atom.xml"><img src="/images/badges/rss-circle-small.png" alt="Rss" /></a></li>
	</ul>
</section>

<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/Conferences/'>Conferences (8)</a></li>
<li class='category'><a href='/blog/categories/FSharp/'>FSharp (3)</a></li>
<li class='category'><a href='/blog/categories/Katas/'>Katas (2)</a></li>
<li class='category'><a href='/blog/categories/StoryTeller/'>StoryTeller (14)</a></li>
<li class='category'><a href='/blog/categories/StructureMap/'>StructureMap (9)</a></li>
<li class='category'><a href='/blog/categories/Testing/'>Testing (20)</a></li>
<li class='category'><a href='/blog/categories/Uncategorized/'>Uncategorized (8)</a></li>
<li class='category'><a href='/blog/categories/dotnet/'>dotnet (65)</a></li>
<li class='category'><a href='/blog/categories/ruby/'>ruby (3)</a></li>
<li class='category'><a href='/blog/categories/sw-design/'>sw-design (13)</a></li>
<li class='category'><a href='/blog/categories/xUnitBDDExtensions/'>xUnitBDDExtensions (15)</a></li>

  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("bjoernrochel", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/bjoernrochel" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @bjoernrochel</a>
  
</section>

<section>
<h1>Disclaimer</h1>
<p>
The opinions expressed herein are my own personal opinions and do not necessarily represent the opinion of any other organization or person, including (but not limited to) my fellow employees, my employer, its clients or their agents. 
</p>
<p>
 Copyright &copy; 2011 - Björn Rochel
</p>
<section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - Björn Rochel -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'bjro';
      
        

				//var disqus_developer = 1;
				var disqus_identifier = 'http://www.bjoernrochel.de/2009/08/07/diving-into-the-storyteller-trunk-part-6-the-main-players-in-the-screen-activation-lifecycle/';
				var disqus_url = 'http://www.bjoernrochel.de/2009/08/07/diving-into-the-storyteller-trunk-part-6-the-main-players-in-the-screen-activation-lifecycle/';
        var disqus_script = 'embed.js';
      

    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
